/** @format */

function displayLinks() {
  let ampLinksDiv = document.getElementById("ampLinks");
  let rawLinks = ampLinksDiv.innerHTML.trim(); // Get AMPscript output

  // Normalize newline variations (Windows uses \r\n, Unix uses \n)
  let linksArray = rawLinks.split(/\r?\n/).map((link) => link.trim()); // Split on newlines
  let outputDiv = document.getElementById("linkOutput");
  let linkCounts = new Map();

  outputDiv.innerHTML = ""; // Clear previous entries

  // Count occurrences of each link
  linksArray.forEach((link) => {
    if (link !== "") {
      linkCounts.set(link, (linkCounts.get(link) || 0) + 1);
    }
  });

  // Display only duplicates
  linkCounts.forEach((count, link) => {
    if (count > 1) {
      // Only show links that appear more than once
      let p = document.createElement("p");
      p.classList.add("duplicate");
      p.textContent = link;
      outputDiv.appendChild(p);
    }
  });

  // If no duplicates exist, inform the user
  if (outputDiv.innerHTML === "") {
    outputDiv.innerHTML = "<p>No duplicates found.</p>";
  }
}

// Run function on page load
window.onload = displayLinks;
