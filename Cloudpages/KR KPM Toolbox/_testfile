/** @format */

const extractFilteredValuesBelow = (keyword) => {
  let results = [];

  for (const cellAddress in sheet) {
    if (sheet[cellAddress]?.v === keyword) {
      const columnLetter = cellAddress.match(/[A-Z]+/)[0]; // Extract column letter
      const rowNumber = parseInt(cellAddress.match(/\d+/)[0]); // Extract row number

      // Determine the cell below (increase row number by 1)
      const belowCellAddress = columnLetter + (rowNumber + 1);

      // Get value and exclude unwanted values
      const belowValue = sheet[belowCellAddress]?.v || "No data found";
      if (belowValue !== "XXX" && belowValue !== "No data found") {
        results.push({ address: belowCellAddress, value: belowValue });
      }
    }
  }

  return results.length > 0
    ? results
    : [{ address: null, value: "Keyword not found" }];
};

// Example usage:
const campaignNameFilteredValues = extractFilteredValuesBelow("campaign name:");
console.log("Filtered values below:", campaignNameFilteredValues);
