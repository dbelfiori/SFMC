<script runat="server">
Platform.Load("Core", "1");

// Define DEs
var sourceDE = DataExtension.Init("SOURCE_DE_NAME");
var targetDE = DataExtension.Init("TARGET_DE_NAME");

// Retrieve all rows from source
var rows = sourceDE.Rows.Retrieve();

// Loop through each row
for (var i = 0; i < rows.length; i++) {
  var row = rows[i];
  var emailKey = row["EmailAddress"]; // ðŸ”‘ Replace with your primary key field

  // Check if row exists in targetDE
  var exists = targetDE.Rows.Lookup(["EmailAddress"], [emailKey]);

  if (exists) {
    // Update existing row
    targetDE.Rows.Update(row, ["EmailAddress"]);
  } else {
    // Add new row
    targetDE.Rows.Add(row);
  }
}
</script>